(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[263],{4595:function(e,n,s){Promise.resolve().then(s.bind(s,4927))},4927:function(e,n,s){"use strict";s.r(n),s.d(n,{default:function(){return p}});var l=s(7437),t=s(2265);s(381),s(3259);var r=(0,t.memo)(e=>{let n=(0,t.useCallback)(()=>{e.onTaskClickFunc(e.taskId)},[e]);return(0,l.jsx)("button",{className:"TaskButton",onClick:n,children:e.taskName},e.taskId)}),a=s(2670),i=s(7957),u=s(1991);let c=u.Ry({name:u.Z_().min(3,"название задачи должно быть длиннее 3 символов"),description:u.Z_().nullable()});var d=s(4073),o=s(1974),m=s(8121),h=s(7313),f=s(7421),x=s(9009),p=(0,t.memo)(()=>{let[e,n]=(0,t.useState)(""),[s,u]=(0,t.useState)("display"),{user:p}=(0,f.AuthContext)(),j=p.user,{handleSubmit:v,register:k,formState:{errors:b},getValues:g,resetField:y}=(0,a.cI)({resolver:(0,i.X)(c)}),[C,S]=(0,t.useState)([]);(0,t.useEffect)(()=>{let e=(0,m.cf)((0,m.hJ)(h.db,"users",null==j?void 0:j.uid,"tasks"),e=>{S(e.docs.map(e=>e.data()))});return()=>e()},[null==j?void 0:j.uid]),(0,t.useEffect)(()=>{(null==Z?void 0:Z.name)!=""&&u("display")},[e]);let N=(0,t.useCallback)(e=>(0,l.jsx)(r,{taskName:e.name,taskId:e.id,onTaskClickFunc:n},e.id),[]),I=(0,t.useCallback)(async()=>{let e=crypto.randomUUID();try{await (0,m.pl)((0,m.JU)(h.db,"users",null==j?void 0:j.uid,"tasks",e),{id:e,name:"Новая задача",description:""}),n(e),u("redact")}catch(e){console.log("errors",JSON.stringify(e,null,2))}},[null==j?void 0:j.uid]),_=(0,t.useCallback)(()=>{y("name"),y("description"),u("redact")},[]),J=(0,t.useCallback)(async()=>{try{let n=g();console.log("values",JSON.stringify(n,null,2)),await (0,x.r7)((0,m.JU)(h.db,"users",null==j?void 0:j.uid,"tasks",e),{name:n.name,description:n.description}),u("display")}catch(e){console.log("errors",JSON.stringify(e,null,2))}u("display")},[e,g,null==j?void 0:j.uid]),F=(0,t.useCallback)(async()=>{try{await (0,m.oe)((0,m.JU)(h.db,"users",null==j?void 0:j.uid,"tasks",e)),n("")}catch(e){console.log("errors",JSON.stringify(e,null,2))}},[e,null==j?void 0:j.uid]),Z=(0,t.useMemo)(()=>C.find(n=>n.id===e),[e,C]);return(0,l.jsx)("div",{children:(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{children:" Задачи "}),(0,l.jsxs)("span",{children:[(0,l.jsx)("span",{children:(0,l.jsxs)("span",{children:[C.map(N),(0,l.jsx)("button",{className:"TaskButton",onClick:I,children:" + "})]})}),(0,l.jsxs)("div",{children:["display"===s&&""!=e?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("h1",{children:null==Z?void 0:Z.name}),(0,l.jsx)("div",{children:null==Z?void 0:Z.description}),(0,l.jsxs)("p",{children:[(0,l.jsx)(d.Z,{onClickFunk:F,label:"удалить"}),(0,l.jsx)(d.Z,{onClickFunk:_,label:"редактировать"})]})]}):null,"redact"===s&&""!=e?(0,l.jsxs)("form",{onSubmit:v(J),children:[(0,l.jsxs)("h1",{children:["Имя задачи",(0,l.jsx)(o.UP,{register:k,name:"name",label:"",type:"text",placeholder:"",error:b.name,defaultValue:null==Z?void 0:Z.name})]}),(0,l.jsxs)("div",{children:["Описание задачи",(0,l.jsx)(o.ox,{register:k,name:"description",label:"",placeholder:"",defaultValue:null==Z?void 0:Z.description})]}),(0,l.jsx)(d.Z,{label:"Сохранить"})]}):null]})]})]})})})},7421:function(e,n,s){"use strict";s.r(n),s.d(n,{AuthContext:function(){return i}});var l=s(7437),t=s(2265),r=s(7313);s(2182),s(161);let a=(0,t.createContext)({}),i=()=>(0,t.useContext)(a);n.default=e=>{let{children:n}=e,[s,i]=(0,t.useState)(!0),[u,c]=(0,t.useState)({user:null,isLogin:!1});return(0,t.useEffect)(()=>r.I.onAuthStateChanged(e=>{c({isLogin:!!e,user:e}),i(!1)}),[]),console.log("useState",u.user),(0,l.jsxs)(a.Provider,{value:{user:u,setUser:c},children:[s?(0,l.jsxs)("div",{className:"LoaderScreen",children:[(0,l.jsx)("span",{className:"Loader"})," "]}):null,s?null:n]})}},7313:function(e,n,s){"use strict";s.d(n,{I:function(){return i},db:function(){return u}});var l=s(6142),t=s(2738),r=s(8121);let a=(0,l.ZF)({apiKey:"AIzaSyA9gyR2Vzlx4Wbp0nLY7JnTGPwYk2rkxMQ",authDomain:"scrum-manager-e0978.firebaseapp.com",projectId:"scrum-manager-e0978",storageBucket:"scrum-manager-e0978.appspot.com",messagingSenderId:"116287469649",appId:"1:116287469649:web:582bb4f590465ef21d6070"}),i=(0,t.v0)(a),u=(0,r.ad)(a)},1974:function(e,n,s){"use strict";s.d(n,{UP:function(){return t},ox:function(){return r}});var l=s(7437);s(3595);let t=e=>{let{label:n,type:s,name:t,placeholder:r,register:a,error:i,defaultValue:u}=e;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("b",{children:[(0,l.jsx)("label",{children:n}),(0,l.jsx)("input",{...a(t,{required:"error message"}),type:s,name:t,placeholder:r,id:"field_".concat(t),defaultValue:u})]}),i&&(0,l.jsx)("var",{children:null==i?void 0:i.message})]})},r=e=>{let{label:n,name:s,placeholder:t,register:r,error:a,defaultValue:i}=e;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("b",{children:[(0,l.jsx)("label",{children:n}),(0,l.jsx)("textarea",{...r(s,{required:"error message"}),name:s,placeholder:t,id:"field_".concat(s),defaultValue:i})]}),a&&(0,l.jsx)("var",{children:null==a?void 0:a.message})]})};n.ZP=t},4073:function(e,n,s){"use strict";var l=s(7437);s(3649),n.Z=e=>{let{label:n,onClickFunk:s}=e;return(0,l.jsx)("a",{children:(0,l.jsx)("button",{onClick:s,children:n})})}},381:function(){},2182:function(){},3595:function(){},161:function(){},3649:function(){},3259:function(){}},function(e){e.O(0,[358,54,449,342,971,69,744],function(){return e(e.s=4595)}),_N_E=e.O()}]);